/*
 * SQL SCHEMA definition for SAP HANA
 */

CREATE SCHEMA WIS;
GRANT SELECT ON SCHEMA WIS to _SYS_REPO WITH GRANT OPTION; /* Allow creating "views" on this schema */

CREATE TABLE WIS.WAHLKREIS (
	nr INT,
	name VARCHAR(13),
	sitzzahl INT,
	PRIMARY KEY(nr));

CREATE TABLE WIS.STIMMKREIS (
	nr INT,
	jahr INT,
	name NVARCHAR(47),
	wahlkreis INT,
	PRIMARY KEY(nr,jahr),
	FOREIGN KEY (wahlkreis) REFERENCES WIS.WAHLKREIS ON DELETE CASCADE);

CREATE TABLE WIS.PARTEI (
	id INT PRIMARY KEY,
	abkuerzung NVARCHAR(20),
	name NVARCHAR(93),
	farbe VARCHAR(6));

CREATE TABLE WIS.KANDIDAT (
	id INT,
	titel VARCHAR(10),
	jahr INT,
	vorname NVARCHAR(20),
	nachname NVARCHAR(20),
	partei INT REFERENCES WIS.PARTEI,
	PRIMARY KEY (id, jahr));

CREATE TABLE WIS.WAHLKREISLISTE (
	kandidat INT ,
	jahr INT,
	wahlkreis INT,
	kandidatpos INT,
	PRIMARY KEY (kandidat,jahr),
	FOREIGN KEY (wahlkreis) REFERENCES WIS.WAHLKREIS ON DELETE CASCADE,
	FOREIGN KEY (kandidat, jahr) REFERENCES WIS.KANDIDAT ON DELETE CASCADE);


CREATE TABLE WIS.STIMMKREISLISTE (
	kandidat INT,
	jahr INT,
	stimmkreis INT,
	kandidatpos INT,
	PRIMARY KEY(kandidat,jahr),
	FOREIGN KEY (stimmkreis,jahr) REFERENCES WIS.STIMMKREIS ON DELETE CASCADE,
	FOREIGN KEY (kandidat, jahr) REFERENCES WIS.KANDIDAT ON DELETE CASCADE);

CREATE TABLE WIS.ERSTSTIMME (
	kandidat INT,
	stimmkreis INT,
	jahr INT,
	FOREIGN KEY (kandidat, jahr) REFERENCES WIS.KANDIDAT,
	FOREIGN KEY (stimmkreis, jahr) REFERENCES WIS.STIMMKREIS);

		CREATE TABLE WIS.ERSTSTIMME (
			kandidat INT,
			stimmkreis INT,
			jahr INT,
			FOREIGN KEY (kandidat, jahr) REFERENCES WIS.KANDIDAT,
			FOREIGN KEY (stimmkreis, jahr) REFERENCES WIS.STIMMKREIS);

CREATE TABLE WIS.ZWEITSTIMMEPARTEI (
	parteiId INT REFERENCES WIS.PARTEI ON DELETE SET NULL,
	stimmkreis INT,
	jahr INT,
	FOREIGN KEY (stimmkreis,jahr) REFERENCES WIS.stimmkreis);

CREATE TABLE WIS.ZWEITSTIMMEKANDIDAT (
	kandidat INT,
	stimmkreis INT,
	jahr INT,
	FOREIGN KEY (kandidat, jahr) REFERENCES WIS.KANDIDAT,
	FOREIGN KEY (stimmkreis,jahr) REFERENCES WIS.STIMMKREIS);
